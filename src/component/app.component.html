<div class="city_background">
</div>

<main-menu />
<undo-redo-menu />
<navigation-menu />

@for (building of city.getBuildingsCopy(); track $index) {
    @if(building.getOccupiedArea().isIntersectingRectList( currentBuildingTool.getOccupiedArea() )) {
        @for (r of building.getOccupiedArea().rects; track $index) {
            <div class="building_placement occupied_area"
                [style.left]="r.getTopLeft().getPixelsX()" [style.top]="r.getTopLeft().getPixelsY()"
                [style.width]="r.getSize().getPixelsX()" [style.height]="r.getSize().getPixelsY()">
            </div>
        }
    }

    <img class="building_placement"
        [src]="building.type.imagePath"
        [style.left]="building.pos.getPixelsX()" 
        [style.top]="building.pos.getPixelsY()"
        [style.width]="building.type.imageSize.getPixelsX()"
        [style.height]="building.type.imageSize.getPixelsY()"
        [alt]="building.type.name" [title]="building.type.name" />
}

@if (currentBuildingTool.type.name != "") {
    @if(currentBuildingTool.type.name != "Demolish") {
    <div class="building_placement gizmo_area" [class.gizmo_ok]="city.isPlaceable(currentBuildingTool)"
        [style.left]="getMouseCenteredGizmoPos().getPixelsX()"
        [style.top]="getMouseCenteredGizmoPos().getPixelsY()" >
    </div>
    }

    @if(!city.isPlaceable(currentBuildingTool) && currentBuildingTool.type.name != "Demolish") {
        @for (r of currentBuildingTool.getOccupiedArea().rects; track $index) {
            <div class="building_placement occupied_area"
                [style.left]="r.getTopLeft().getPixelsX()" [style.top]="r.getTopLeft().getPixelsY()"
                [style.width]="r.getSize().getPixelsX()" [style.height]="r.getSize().getPixelsY()">
            </div>
        }
    }

    <img class="building_placement"
        [src]="currentBuildingTool.type.imagePath"
        [style.left]="currentBuildingTool.pos.getPixelsX()" 
        [style.top]="currentBuildingTool.pos.getPixelsY()"
        [style.width]="currentBuildingTool.type.imageSize.getPixelsX()"
        [style.height]="currentBuildingTool.type.imageSize.getPixelsY()"
        (click)="placeBuilding(buildingPalette)">
}

<building-palette (buildingToolSelectedEvent)="buildingToolSelectedEvent($event)" #buildingPalette />

<version-information />

<router-outlet></router-outlet>
